mongodb:
  image: dockerfile/mongodb
  ports:
    - "27017:27017"
  name: mongodb
  command: mongod --smallfiles --nojournal --noprealloc
  
admininstall:
  image: igzjavierperez/egn_nodejs
  volumes:
    - .:/data
  command: npm install

serverinstall:
  image: igzjavierperez/egn_nodejs
  volumes:
    - ../server:/data
  command: npm install

redis:
  image: redis 
  ports:
    - "6379:6379"

rabbit:
  image: dockerfile/rabbitmq
  ports:
    - "5672:5672"
    - "15672:15672"

admin:
  image: igzjavierperez/egn_nodejs
  links:
    - mongodb
    - server
  volumes:
    - .:/data
    - /tmp/egn:/tmp/egn
  ports:
    - "3001:3001"
  name: admin
  command: npm run-script docker-server

server:
  image: igzjavierperez/egn_nodejs
  links:
    - mongodb
  volumes:
    - ../server:/data
    - /tmp/egn:/tmp/egn
  ports:
    - "3000:3000"
  name: server
  command: npm run-script docker-server

elasticsearch:
  image: digitalwonderland/elasticsearch
  ports:
    - "9200:9200"

logstash:
  image: digitalwonderland/logstash
  links:
    - elasticsearch

logstashforwarder:
  image: digitalwonderland/logstash-forwarder
  volumes:
    - /var/lib/docker:/var/lib/docker:ro
    - /var/run/docker.sock:/var/run/docker.sock
  volumes_from:
    - logstash
  links:
    - logstash
  

