elasticsearch:
  image: elasticsearch:1.4.4
  ports:
    - "9200:9200"
kibana:
  image: thegameofcode/kibana
  links:
    - elasticsearch
  ports:
    - "5601:5601"
client:
  image: thegameofcode/ubuntu
  links:
    - "bunyan:bunyan"
    - "server:server"
  volumes:
    - "$PWD/ubuntu-client/45-test.conf:/etc/rsyslog.d/45-test.conf"
  volumes_from:
    - bunyan
  expose:
    - "11514:11514"
server:
  image: thegameofcode/ubuntu
  links:
    - "elasticsearch:elasticsearch"
  volumes:
    - "$PWD/ubuntu-server/45-test.conf:/etc/rsyslog.d/45-test.conf"
bunyan:
  image: thegameofcode/bunyan
  volumes:
    - "$PWD/bunyan/test.js:/test.js"
    - "$PWD/bunyan/buyan.log:/var/log/bunyan.log"
  command: bash -c "echo -n > /var/log/bunyan.log && (node /test.js &) && tail -f /var/log/bunyan.log"